<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìœ ì‚¬ë„ í…ŒìŠ¤íŠ¸</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f8f6fa; margin: 0; padding: 0; }
    .container { max-width: 420px; margin: 40px auto; background: #fff; border-radius: 12px; box-shadow: 0 2px 8px #0001; padding: 24px; }
    h1 { text-align: center; color: #6f2aa1; }
    #utest-progress { font-size: 1em; color: #6f2aa1; margin-bottom: 8px; text-align: right; }
    #utest-question { font-size: 1.1em; font-weight: bold; margin-bottom: 16px; min-height: 32px; }
    #utest-options { margin-bottom: 16px; }
    .utest-btn { padding: 10px 18px; border: none; border-radius: 6px; background: #6f2aa1; color: #fff; font-size: 1em; cursor: pointer; margin: 6px 8px 0 0; }
    .utest-btn:disabled { background: #aaa; cursor: not-allowed; }
    #utest-result { margin: 24px 0 0 0; text-align: center; min-height: 60px; }
    #msg { margin: 12px 0; color: #d9534f; min-height: 20px; text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ§‘â€ğŸ¤â€ğŸ§‘ ìœ ì‚¬ë„ í…ŒìŠ¤íŠ¸</h1>
    <div id="utest-progress"></div>
    <div id="utest-question"></div>
    <div id="utest-options"></div>
    <div id="utest-result"></div>
    <div id="msg"></div>
  </div>
  <script type="module">
    import './firebase-config.js';
    import { StarSystem } from './star-system.js';
    import './utest.js';

    // í€´ì¦ˆ ë°ì´í„°(ìƒ˜í”Œ, ì‹¤ì œë¡œëŠ” ë” ë§ì€ ì§ˆë¬¸ ê°€ëŠ¥)
    const quiz = [
      { question: "ì¶”ì–µì„ ë– ì˜¬ë¦¬ëŠ” ê°ê°ì€?", options: ["ëƒ„ìƒˆ", "ì†Œë¦¬", "ì´‰ê°(ì˜¨ë„, ì§ˆê°)", "ë¯¸ê°"], answer: ["ì´‰ê°", "ì†Œë¦¬"] },
      { question: "ê°€ì¥ ê·¸ë¦¬ìš´ ì‹œì ˆì€?", options: ["ê±±ì • ì—†ë˜ ì–´ë¦° ì‹œì ˆ", "ìê° ì—†ì´ ì§€ë‚˜ê°„ ì–´ëŠ ë•Œ", "í›„íšŒê°€ ë§ë˜ ìˆœê°„ë“¤", "ì§€ê¸ˆ ì´ ë¬´ë µ"], answer: ["ìê° ì—†ì´ ì§€ë‚˜ê°„ ì–´ëŠ ë•Œ", "ì§€ê¸ˆ ì´ ë¬´ë µ"] },
      { question: "ì¢‹ì•„í•˜ëŠ” ë‚ ì”¨ëŠ”?", options: ["ë§‘ìŒ", "ë¹„", "ëˆˆ", "íë¦¼"], answer: ["ë§‘ìŒ"] },
      { question: "ì„ í˜¸í•˜ëŠ” ì‹œê°„ì˜ ì²´ê°ì€?", options: ["ì—¬ìœ ë¡œì›€", "ë¿Œë“¯í•¨", "ììœ ë¡œì›€", "ì¼ìƒì ì„"], answer: ["ì—¬ìœ ë¡œì›€", "ììœ ë¡œì›€"] },
      { question: "í¸í•œ ëŒ€í™” ìƒëŒ€ëŠ”?", options: ["ì„œë¡œì˜ ì¹¨ë¬µë„ í¸ì•ˆí•œ ì‚¬ëŒ", "í™œê¸°ì°¨ê³  ì¦ê±°ìš´ ë¶„ìœ„ê¸°ì˜ ì‚¬ëŒ", "ë¬´ìŠ¨ ìƒê°ì¸ì§€ ì•Œê¸° ì–´ë ¤ìš´ ì‚¬ëŒ", "ìµìˆ™í•˜ê³  ë°˜ë³µë˜ëŠ” ì´ì•¼ê¸°ì˜ ì‚¬ëŒ"], answer: ["ì„œë¡œì˜ ì¹¨ë¬µë„ í¸ì•ˆí•œ ì‚¬ëŒ", "ë¬´ìŠ¨ ìƒê°ì¸ì§€ ì•Œê¸° ì–´ë ¤ìš´ ì‚¬ëŒ"] },
      { question: "ì‚¬ëŒë“¤ì´ ë‹¹ì‹ ì„ ë³¼ ë•Œ ê°€ì¥ ìì£¼ ë§í•˜ëŠ” í‰ê°€ëŠ”?", options: ["ê¹Šì´ ìˆê³  ìƒê°ì´ ë§ì€ ì‚¬ëŒ", "ë”°ëœ»í•˜ê³  í¸ì•ˆí•œ ì‚¬ëŒ", "íŠ¹ì´í•˜ê³  ë…ì°½ì ì¸ ì‚¬ëŒ", "ì„±ì‹¤í•˜ê³  ì±…ì„ê° ìˆëŠ” ì‚¬ëŒ"], answer: ["ê¹Šì´ ìˆê³  ìƒê°ì´ ë§ì€ ì‚¬ëŒ", "íŠ¹ì´í•˜ê³  ë…ì°½ì ì¸ ì‚¬ëŒ"] },
      { question: "ì§€ì³¤ì„ ë•Œ ì°¾ëŠ” ê²ƒì€?", options: ["ìœ„ë¡œí•´ì¤„ ëˆ„êµ°ê°€", "ì¹˜ìœ ë°›ëŠ” ì¥ì†Œ", "ì¦ê±°ì›€, ì¾Œë½", "í˜¼ìë§Œì˜ ì‹œê°„"], answer: ["í˜¼ìë§Œì˜ ì‹œê°„", "ì¹˜ìœ ë°›ëŠ” ì¥ì†Œ"] },
      { question: "ì§€ê¸ˆ ê°€ì¥ í•„ìš”í•œ ê°ì •ì€?", options: ["ìœ„ë¡œ", "ìê·¹", "ì•ˆì •", "ëª°ì…"], answer: ["ì•ˆì •", "ëª°ì…"] },
      { question: "ê¸°ì–µì„ ì„ ëª…í•˜ê²Œ ë§Œë“œëŠ” ê²ƒì€?", options: ["ê°ê°", "ì‚¬ì§„", "ìµìˆ™í•œ ì¥ì†Œ", "ê¿ˆ"], answer: ["ê¿ˆ", "ê°ê°"] },
      { question: "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ê³„ì ˆì€?", options: ["ë´„", "ì—¬ë¦„", "ê°€ì„", "ê²¨ìš¸"], answer: ["ê°€ì„", "ë´„"] }
    ];

    function getCurrentUser() {
      return window.firebaseAuth && window.firebaseAuth.currentUser;
    }

    const msgBox = document.getElementById('msg');
    function showMsg(msg, color='#6f2aa1') {
      msgBox.textContent = msg;
      msgBox.style.color = color;
    }

    let starSystem, utest;
    async function init() {
      if (!getCurrentUser()) {
        showMsg('ë¡œê·¸ì¸ í›„ ì´ìš©í•´ ì£¼ì„¸ìš”.', '#d9534f');
        return;
      }
      starSystem = new StarSystem({ auth: window.firebaseAuth, db: window.firebaseDB });
      starSystem.setUser(getCurrentUser());
      utest = new window.UTest(starSystem, quiz);
      utest.startQuiz();
      showMsg('ì§ˆë¬¸ì— ë‹µí•´ë³´ì„¸ìš”!');
    }

    // Firebase ì¸ì¦ ìƒíƒœ ë³€í™” ê°ì§€
    import('https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js').then(mod => {
      const onAuthStateChanged = mod.onAuthStateChanged || (mod.default && mod.default.onAuthStateChanged);
      if (typeof onAuthStateChanged !== 'function') return;
      onAuthStateChanged(window.firebaseAuth, () => {
        init();
      });
    });
  </script>
</body>
</html>